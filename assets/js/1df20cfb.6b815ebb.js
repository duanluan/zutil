"use strict";(globalThis.webpackChunkzutil_docs=globalThis.webpackChunkzutil_docs||[]).push([[8847],{3440(e,t,n){n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>c,default:()=>x,frontMatter:()=>i,metadata:()=>l,toc:()=>h});const l=JSON.parse('{"id":"reference-doc/crypto/blockCipher","title":"BlockCipher \u5206\u7ec4\u52a0\u5bc6","description":"\ud83d\udce6 \u5305\u8def\u5f84: top.csaf.crypto","source":"@site/docs/003-reference-doc/crypto/002-blockCipher.md","sourceDirName":"003-reference-doc/crypto","slug":"/reference-doc/crypto/blockCipher","permalink":"/zutil/docs/reference-doc/crypto/blockCipher","draft":false,"unlisted":false,"editUrl":"https://github.com/duanluan/zutil/tree/main/docs/docs/003-reference-doc/crypto/002-blockCipher.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Crypto \u679a\u4e3e\u5e38\u91cf","permalink":"/zutil/docs/reference-doc/crypto/cryptoEnums"},"next":{"title":"Md5Util MD5 \u6458\u8981\u5de5\u5177\u7c7b","permalink":"/zutil/docs/reference-doc/crypto/md5Util"}}');var s=n(5656),r=n(5395);const i={},c="BlockCipher \u5206\u7ec4\u52a0\u5bc6",d={},h=[{value:"\ud83d\ude80 \u5de5\u5177\u7c7b\u6982\u89c8",id:"-\u5de5\u5177\u7c7b\u6982\u89c8",level:2},{value:"\ud83d\udcdd \u5e38\u7528\u65b9\u6cd5 (\u4ee5 AesUtil \u4e3a\u4f8b)",id:"-\u5e38\u7528\u65b9\u6cd5-\u4ee5-aesutil-\u4e3a\u4f8b",level:2},{value:"1. \u52a0\u5bc6 (Encrypt)",id:"1-\u52a0\u5bc6-encrypt",level:3},{value:"2. \u89e3\u5bc6 (Decrypt)",id:"2-\u89e3\u5bc6-decrypt",level:3},{value:"3. \u9ad8\u7ea7\u7528\u6cd5\uff1a\u81ea\u5b9a\u4e49 Key/IV \u7f16\u7801",id:"3-\u9ad8\u7ea7\u7528\u6cd5\u81ea\u5b9a\u4e49-keyiv-\u7f16\u7801",level:3},{value:"\ud83d\udee0\ufe0f \u901a\u7528\u5de5\u5177 BlockCipherUtil",id:"\ufe0f-\u901a\u7528\u5de5\u5177-blockcipherutil",level:2},{value:"\u2699\ufe0f \u7b97\u6cd5\u53c2\u6570\u53c2\u8003",id:"\ufe0f-\u7b97\u6cd5\u53c2\u6570\u53c2\u8003",level:2}];function o(e){const t={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"blockcipher-\u5206\u7ec4\u52a0\u5bc6",children:"BlockCipher \u5206\u7ec4\u52a0\u5bc6"})}),"\n",(0,s.jsxs)(t.blockquote,{children:["\n",(0,s.jsxs)(t.p,{children:["\ud83d\udce6 ",(0,s.jsx)(t.strong,{children:"\u5305\u8def\u5f84"}),": ",(0,s.jsx)(t.code,{children:"top.csaf.crypto"})]}),"\n",(0,s.jsxs)(t.p,{children:["\ud83d\udd12 ",(0,s.jsx)(t.strong,{children:"\u5e95\u5c42\u5b9e\u73b0"}),": \u57fa\u4e8e Bouncy Castle \u7684 ",(0,s.jsx)(t.code,{children:"BlockCipher"})," \u5c01\u88c5"]}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:["\u672c\u6a21\u5757\u63d0\u4f9b\u5bf9\u79f0\u52a0\u5bc6\uff08\u5206\u7ec4\u5bc6\u7801\uff09\u7684\u5de5\u5177\u7c7b\u652f\u6301\uff0c\u6db5\u76d6\u4e86\u56fd\u9645\u6807\u51c6\u7b97\u6cd5 ",(0,s.jsx)(t.strong,{children:"AES"}),"\u3001",(0,s.jsx)(t.strong,{children:"DES"})," \u4ee5\u53ca\u56fd\u5bc6\u7b97\u6cd5 ",(0,s.jsx)(t.strong,{children:"SM4"}),"\u3002"]}),"\n",(0,s.jsxs)(t.p,{children:["\u6240\u6709\u5de5\u5177\u7c7b\u5747\u652f\u6301\u81ea\u5b9a\u4e49 ",(0,s.jsx)(t.strong,{children:"\u5de5\u4f5c\u6a21\u5f0f (Mode)"}),"\u3001",(0,s.jsx)(t.strong,{children:"\u586b\u5145\u65b9\u5f0f (Padding)"})," \u4ee5\u53ca ",(0,s.jsx)(t.strong,{children:"\u5bc6\u94a5/IV \u7f16\u7801\u683c\u5f0f"}),"\u3002"]}),"\n",(0,s.jsx)(t.h2,{id:"-\u5de5\u5177\u7c7b\u6982\u89c8",children:"\ud83d\ude80 \u5de5\u5177\u7c7b\u6982\u89c8"}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"\u5de5\u5177\u7c7b\u540d"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"\u7b97\u6cd5"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"\u63cf\u8ff0"})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"AesUtil"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.strong,{children:"AES"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"\u9ad8\u7ea7\u52a0\u5bc6\u6807\u51c6\uff0c\u76ee\u524d\u6700\u5e38\u7528\u7684\u5bf9\u79f0\u52a0\u5bc6\u7b97\u6cd5"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"Sm4Util"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.strong,{children:"SM4"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"\u56fd\u5bc6\u5206\u7ec4\u5bc6\u7801\u7b97\u6cd5\uff0c\u56fd\u5185\u91d1\u878d/\u653f\u52a1\u9886\u57df\u6807\u51c6"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"DesUtil"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.strong,{children:"DES"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"\u6570\u636e\u52a0\u5bc6\u6807\u51c6\uff0c\u5b89\u5168\u6027\u8f83\u4f4e\uff0c\u901a\u5e38\u7528\u4e8e\u517c\u5bb9\u65e7\u7cfb\u7edf"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"BlockCipherUtil"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.strong,{children:"\u901a\u7528"})}),(0,s.jsxs)(t.td,{style:{textAlign:"left"},children:["\u652f\u6301\u52a8\u6001\u4f20\u5165 ",(0,s.jsx)(t.code,{children:"BlockCipherType"})," \u6307\u5b9a\u7b97\u6cd5"]})]})]})]}),"\n",(0,s.jsx)(t.h2,{id:"-\u5e38\u7528\u65b9\u6cd5-\u4ee5-aesutil-\u4e3a\u4f8b",children:"\ud83d\udcdd \u5e38\u7528\u65b9\u6cd5 (\u4ee5 AesUtil \u4e3a\u4f8b)"}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.code,{children:"AesUtil"}),"\u3001",(0,s.jsx)(t.code,{children:"Sm4Util"}),"\u3001",(0,s.jsx)(t.code,{children:"DesUtil"})," \u7684\u65b9\u6cd5\u7b7e\u540d\u5b8c\u5168\u4e00\u81f4\u3002\u4ee5\u4e0b\u4ee5 ",(0,s.jsx)(t.code,{children:"AesUtil"})," \u4e3a\u4f8b\u8fdb\u884c\u8bf4\u660e\u3002"]}),"\n",(0,s.jsx)(t.h3,{id:"1-\u52a0\u5bc6-encrypt",children:"1. \u52a0\u5bc6 (Encrypt)"}),"\n",(0,s.jsxs)(t.p,{children:["\u652f\u6301\u8f93\u51fa\u4e3a ",(0,s.jsx)(t.strong,{children:"Base64"})," \u6216 ",(0,s.jsx)(t.strong,{children:"Hex"})," \u5b57\u7b26\u4e32\u3002"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-java",children:'// \u51c6\u5907\u53c2\u6570\nString content = "Hello World";\nString key = "1234567812345678"; // AES-128 \u9700 16 \u4f4d\nString iv = "1234567812345678";  // CBC \u6a21\u5f0f\u901a\u5e38\u9700 IV\n\n// \u65b9\u5f0f 1: \u52a0\u5bc6\u4e3a Base64\nString b64 = AesUtil.encryptBase64(content, key, iv, Mode.CBC, Padding.PKCS7);\n// -> "SGVsbG8..."\n\n// \u65b9\u5f0f 2: \u52a0\u5bc6\u4e3a Hex\nString hex = AesUtil.encryptHex(content, key, iv, Mode.CBC, Padding.PKCS7);\n// -> "48656c6c6f..."\n'})}),"\n",(0,s.jsxs)(t.blockquote,{children:["\n",(0,s.jsxs)(t.p,{children:["\ud83d\udca1 ",(0,s.jsx)(t.strong,{children:"\u63d0\u793a"}),": \u4f7f\u7528 ",(0,s.jsx)(t.code,{children:"Sm4Util"})," \u6216 ",(0,s.jsx)(t.code,{children:"DesUtil"})," \u65f6\uff0c\u53ea\u9700\u5c06\u7c7b\u540d\u66ff\u6362\u5373\u53ef\uff0c\u53c2\u6570\u7528\u6cd5\u5b8c\u5168\u76f8\u540c\u3002"]}),"\n"]}),"\n",(0,s.jsx)(t.h3,{id:"2-\u89e3\u5bc6-decrypt",children:"2. \u89e3\u5bc6 (Decrypt)"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-java",children:"// \u89e3\u5bc6 Base64\nString plain1 = AesUtil.decryptBase64(b64, key, iv, Mode.CBC, Padding.PKCS7);\n\n// \u89e3\u5bc6 Hex\nString plain2 = AesUtil.decryptHex(hex, key, iv, Mode.CBC, Padding.PKCS7);\n"})}),"\n",(0,s.jsx)(t.h3,{id:"3-\u9ad8\u7ea7\u7528\u6cd5\u81ea\u5b9a\u4e49-keyiv-\u7f16\u7801",children:"3. \u9ad8\u7ea7\u7528\u6cd5\uff1a\u81ea\u5b9a\u4e49 Key/IV \u7f16\u7801"}),"\n",(0,s.jsxs)(t.p,{children:["\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c",(0,s.jsx)(t.code,{children:"key"})," \u548c ",(0,s.jsx)(t.code,{children:"iv"})," \u88ab\u89c6\u4e3a\u666e\u901a\u5b57\u7b26\u4e32\uff08UTF-8\uff09\u3002\u5982\u679c\u4f60\u7684\u5bc6\u94a5\u672c\u8eab\u662f ",(0,s.jsx)(t.strong,{children:"Hex"})," \u6216 ",(0,s.jsx)(t.strong,{children:"Base64"})," \u683c\u5f0f\uff0c\u9700\u6307\u5b9a ",(0,s.jsx)(t.code,{children:"EncodingType"}),"\u3002"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-java",children:'// \u5047\u8bbe\u5bc6\u94a5\u662f Hex \u683c\u5f0f\u5b57\u7b26\u4e32\nString hexKey = "31323334353637383132333435363738"; // "1234567812345678" \u7684 Hex\n\nString result = AesUtil.encryptBase64(\n    "Hello", \n    hexKey, EncodingType.HEX, // \ud83d\udc48 \u6307\u5b9a Key \u4e3a Hex\n    iv, EncodingType.UTF_8,   // IV \u4ecd\u4e3a\u666e\u901a\u5b57\u7b26\u4e32\n    Mode.CBC, \n    Padding.PKCS7\n);\n'})}),"\n",(0,s.jsx)(t.hr,{}),"\n",(0,s.jsx)(t.h2,{id:"\ufe0f-\u901a\u7528\u5de5\u5177-blockcipherutil",children:"\ud83d\udee0\ufe0f \u901a\u7528\u5de5\u5177 BlockCipherUtil"}),"\n",(0,s.jsxs)(t.p,{children:["\u5982\u679c\u4f60\u9700\u8981\u5728\u8fd0\u884c\u65f6\u52a8\u6001\u51b3\u5b9a\u52a0\u5bc6\u7b97\u6cd5\uff0c\u53ef\u4ee5\u4f7f\u7528 ",(0,s.jsx)(t.code,{children:"BlockCipherUtil"}),"\u3002\u5b83\u6bd4\u4e0a\u8ff0\u5de5\u5177\u7c7b\u591a\u4e00\u4e2a ",(0,s.jsx)(t.code,{children:"BlockCipherType"})," \u53c2\u6570\u3002"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-java",children:'// \u52a8\u6001\u6307\u5b9a\u4e3a SM4 \u7b97\u6cd5\nString result = BlockCipherUtil.encryptBase64(\n    BlockCipherType.SM4, // \ud83d\udc48 \u6307\u5b9a\u7b97\u6cd5\n    "Hello", \n    key, \n    iv, \n    Mode.CBC, \n    Padding.PKCS7\n);\n'})}),"\n",(0,s.jsx)(t.hr,{}),"\n",(0,s.jsx)(t.h2,{id:"\ufe0f-\u7b97\u6cd5\u53c2\u6570\u53c2\u8003",children:"\u2699\ufe0f \u7b97\u6cd5\u53c2\u6570\u53c2\u8003"}),"\n",(0,s.jsxs)(t.p,{children:["\u4e0d\u540c\u7b97\u6cd5\u5bf9 ",(0,s.jsx)(t.strong,{children:"\u5bc6\u94a5 (Key)"})," \u548c ",(0,s.jsx)(t.strong,{children:"\u504f\u79fb\u91cf (IV)"})," \u7684\u957f\u5ea6\u6709\u4e25\u683c\u8981\u6c42\uff08\u5355\u4f4d\uff1a\u5b57\u8282/Byte\uff09\uff1a"]}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"\u7b97\u6cd5"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"\u5bc6\u94a5\u957f\u5ea6 (Byte)"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"IV \u957f\u5ea6 (Byte)"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"\u8bf4\u660e"})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.strong,{children:"AES"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"16, 24, 32"}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"16"}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"\u5bf9\u5e94 AES-128, AES-192, AES-256"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.strong,{children:"SM4"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"16"}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"16"}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"\u56fa\u5b9a 128 \u4f4d"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.strong,{children:"DES"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"8"}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"8"}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"\u5b9e\u9645\u6709\u6548\u4f4d 56 \u4f4d"})]})]})]}),"\n",(0,s.jsxs)(t.blockquote,{children:["\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"\u6ce8\u610f"}),": \u5982\u679c Key/IV \u957f\u5ea6\u4e0d\u7b26\u5408\u8981\u6c42\uff0c\u4f1a\u629b\u51fa\u5f02\u5e38\u3002"]}),"\n"]})]})}function x(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(o,{...e})}):o(e)}},5395(e,t,n){n.d(t,{R:()=>i,x:()=>c});var l=n(7140);const s={},r=l.createContext(s);function i(e){const t=l.useContext(r);return l.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function c(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),l.createElement(r.Provider,{value:t},e.children)}}}]);